@model hpMvc.Models.EnteralFormula 
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@{    
    var sWeight = "";
    var cDate = "";
    var calStudyId = 0;
    var hours = 0;
    var studyDay = "";
}
@if (ViewBag.CalStudyID > 0)
{    
    sWeight = @ViewBag.Weight;
    cDate = @ViewBag.CalcDate;
    calStudyId = @ViewBag.CalStudyID;
    hours = @ViewBag.Hours;
    studyDay = (string)@ViewBag.StudyDay;
}

        
<h2>Calorie Calculator</h2>
<hr />

<form action="" method="post">
    <input type="hidden" name="calStudyID" id="calStudyID" value="@calStudyId" />
    <div id="divMainTop">        
        <label class="lblmain">Study ID</label> @Html.DropDownList("StudyList")
        <br />
        <label class="lblmain">Hours in Study Day </label><input type="text" id="hours" name="hours" value="@hours"/>
        <br />       
        <label class="lblmain">Weight (kg)</label><input type="text" id="bodyWeight" name="bodyWeight" value="@sWeight"/>        
        <br />
        <label class="lblmain">Date (mm/dd/yyyy)</label><input type="text" id="calcDate" name="calcDate" value="@cDate"/>
        <br />
        <label class="lblmain">Study Day </label><input type="text" readonly="readonly" id="studyDay" value="@studyDay"/>
        <br />
    </div>
    <div id="tabs">
        <ul id="tabsNav">
            <li><a href="#Fluid">Fluid Infusions</a></li>
            <li><a href="#Parenteral">Parenteral Nutrition</a></li>
            <li><a href="#Enteral">Enteral Nutrition</a></li>
            <li><a href="#Additives">Additives</a></li>
            <li><a href="#Other">Other Nutrition</a></li>
        </ul>
        <div id="Fluid">
            <table id="tblInfusion">
                <tr>
                    <th>@Html.DropDownList("DexCons1")</th>
                    <th>@Html.DropDownList("DexCons2")</th>
                    <th>@Html.DropDownList("DexCons3")</th>
                    <th>@Html.DropDownList("DexCons4")</th>
                </tr>
                <tr>
                    <td><input type="text" class="infusions1 keyDecimal" /><label>&nbsp;mL</label> </td>
                    <td><input type="text" class="infusions2 keyDecimal" /><label>&nbsp;mL</label> </td>
                    <td><input type="text" class="infusions3 keyDecimal" /><label>&nbsp;mL</label> </td>
                    <td><input type="text" class="infusions4 keyDecimal" /><label>&nbsp;mL</label> </td>
                </tr>
                <tr>
                    <td><input type="text" class="infusions1 keyDecimal" /><label>&nbsp;mL</label> </td>
                    <td><input type="text" class="infusions2 keyDecimal" /><label>&nbsp;mL</label> </td>
                    <td><input type="text" class="infusions3 keyDecimal" /><label>&nbsp;mL</label> </td>
                    <td><input type="text" class="infusions4 keyDecimal" /><label>&nbsp;mL</label> </td>
                </tr>
                <tr>
                    <td><input type="text" class="infusions1 keyDecimal" /><label>&nbsp;mL</label> </td>
                    <td><input type="text" class="infusions2 keyDecimal" /><label>&nbsp;mL</label> </td>
                    <td><input type="text" class="infusions3 keyDecimal" /><label>&nbsp;mL</label> </td>
                    <td><input type="text" class="infusions4 keyDecimal" /><label>&nbsp;mL</label> </td>
                </tr>
                <tr>
                    <td><input type="text" class="infusions1 keyDecimal" /><label>&nbsp;mL</label> </td>
                    <td><input type="text" class="infusions2 keyDecimal" /><label>&nbsp;mL</label> </td>
                    <td><input type="text" class="infusions3 keyDecimal" /><label>&nbsp;mL</label> </td>
                    <td><input type="text" class="infusions4 keyDecimal" /><label>&nbsp;mL</label> </td>
                </tr>
                <tr>
                    <td><input type="text" class="infusions1 keyDecimal" /><label>&nbsp;mL</label> </td>
                    <td><input type="text" class="infusions2 keyDecimal" /><label>&nbsp;mL</label> </td>
                    <td><input type="text" class="infusions3 keyDecimal" /><label>&nbsp;mL</label> </td>
                    <td><input type="text" class="infusions4 keyDecimal" /><label>&nbsp;mL</label> </td>
                </tr>
                <tr>
                    <td><input type="text" class="infusions1 keyDecimal" /><label>&nbsp;mL</label> </td>
                    <td><input type="text" class="infusions2 keyDecimal" /><label>&nbsp;mL</label> </td>
                    <td><input type="text" class="infusions3 keyDecimal" /><label>&nbsp;mL</label> </td>
                    <td><input type="text" class="infusions4 keyDecimal" /><label>&nbsp;mL</label> </td>
                </tr>
                <tr>
                    <td><input type="text" class="infusions1 keyDecimal" /><label>&nbsp;mL</label> </td>
                    <td><input type="text" class="infusions2 keyDecimal" /><label>&nbsp;mL</label> </td>
                    <td><input type="text" class="infusions3 keyDecimal" /><label>&nbsp;mL</label> </td>
                    <td><input type="text" class="infusions4 keyDecimal" /><label>&nbsp;mL</label> </td>
                </tr>
                <tr>
                    <td><input type="text" class="infusions1 keyDecimal" /><label>&nbsp;mL</label> </td>
                    <td><input type="text" class="infusions2 keyDecimal" /><label>&nbsp;mL</label> </td>
                    <td><input type="text" class="infusions3 keyDecimal" /><label>&nbsp;mL</label> </td>
                    <td><input type="text" class="infusions4 keyDecimal" /><label>&nbsp;mL</label> </td>
                </tr>
                <tr>
                    <td><input type="text" class="infusions1 keyDecimal" /><label>&nbsp;mL</label> </td>
                    <td><input type="text" class="infusions2 keyDecimal" /><label>&nbsp;mL</label> </td>
                    <td><input type="text" class="infusions3 keyDecimal" /><label>&nbsp;mL</label> </td>
                    <td><input type="text" class="infusions4 keyDecimal" /><label>&nbsp;mL</label> </td>
                </tr>
                <tr>
                    <td><input type="text" class="infusions1 keyDecimal" /><label>&nbsp;mL</label> </td>
                    <td><input type="text" class="infusions2 keyDecimal" /><label>&nbsp;mL</label> </td>
                    <td><input type="text" class="infusions3 keyDecimal" /><label>&nbsp;mL</label> </td>
                    <td><input type="text" class="infusions4 keyDecimal" /><label>&nbsp;mL</label> </td>
                </tr>
                <tr id="infuseTotalRow">
                    <td><span id="infuse1Total" class="nTotal"><strong>0</strong></span><label>&nbsp;mL</label> </td>
                    <td><span id="infuse2Total" class="nTotal"><strong>0</strong></span><label>&nbsp;mL</label> </td>
                    <td><span id="infuse3Total" class="nTotal"><strong>0</strong></span><label>&nbsp;mL</label> </td>
                    <td><span id="infuse4Total" class="nTotal"><strong>0</strong></span><label>&nbsp;mL</label> </td>
                </tr>                              
            </table>
            
        </div>
        <div id="Parenteral">
            <p>
                Enter the dextrose concentration, amino acid concentration and volume then click add.  Do this for each entry. 
            </p>
            <br />
            <div id="divParenteralEntry">
                <div id="divEnterDex">
                    <label>Dextrose</label><input class="keyDecimal" type="text" id="txtDex"/>&nbsp;<span>%</span><br />
                    <label>Amino Acid</label><input class="keyDecimal" type="text" id="txtAm" />&nbsp;<span>%</span><br />
                    <label>Volume</label><input class="keyDecimal" type="text" id="txtPNVol"/>&nbsp;<span>mL</span>&nbsp;&nbsp;<input type="button" id="btnAddDex" value="Add" />
                </div>
                <div id="divEnterLipid">
                    <label>Lipid Concentration</label>
                    <select id="LipidConc" name="LipidConc">
                        <option value="0"> &nbsp;Select &nbsp;</option>
                        <option value="1.1">10</option>
                        <option value="2.0">20</option>
                        <option value="3.0">30</option>    
                    </select>
                    &nbsp;<span>%</span><br />
                    <label>Volume</label><input class="keyDecimal" type="text" id="txtLPVol"/>&nbsp;<span>mL</span>&nbsp;&nbsp;<input type="button" id="btnAddLip" value="Add" />
                </div>
            </div>
            
            <select multiple="multiple" size="10" id="selParenteral">
                
            </select> 
            &nbsp;&nbsp;<input type="button" id="btnRemoveParenteral" value="Remove Selected" />
        </div>
        <div id="Enteral">
            <div id="EnteralFormula">
                <div class="divInfo">
                    Select the desired <strong>base</strong> formula from the dropdown list, enter a volume then press 'Add' to add entry to the 'Selected Formulas' list box.  To remove a formula from the 'Selected Formulas' list you must first select it and then press 'Remove Selected'. 
                </div>
                <hr />
                <div>
                    Select formula @Html.DropDownList("FormulaList")
                    &nbsp;
                    <label>Volume</label>&nbsp;<input class="keyDecimal" type="text" id="txtVolFormula"/>&nbsp;&nbsp;<span>mL</span>&nbsp;&nbsp;<input type="button" id="btnAddFormula" value="Add" />
                </div>
            </div>
            <div id="EnteralManual">                
                <label>If a formula is not in the list above, click on the 'Add New Formula' button: </label>&nbsp;&nbsp;<input type="button" id="btnAddManual" value="Add New Formula" />
            </div>
            <hr />            
            <div><strong>Selected Formulas</strong></div>
            <select multiple="multiple" size="10" id="selEnteral">
                
            </select> 
            &nbsp;&nbsp;<input type="button" id="btnRemoveEnteral" value="Remove Selected" />
        </div>
        <div id="Additives">
            <div id="AdditivesFormula">
                <div class="divInfo">
                    Select the desired additive from the dropdown list, enter an amount then press 'Add' to add entry to the 'Selected Additives' list box.  To remove an additive from the 'Selected Additives' list you must first select it and then press 'Remove Selected'. 
                </div>
                <hr />
                <div>
                    Select additive @Html.DropDownList("AdditiveList")
                    &nbsp;
                    <label>Amount</label>&nbsp;<input class="keyDecimal" type="text" id="txtAdditiveAmt"/>&nbsp;&nbsp;<span id="spanUnit"></span>&nbsp;&nbsp;<input type="button" id="btnAddAdditive" value="Add" />
                </div>
            </div>
            <div id="AdditiveManual">                
                <label>If an additive is not in the list above, click on the 'Add New Additive' button: </label>&nbsp;&nbsp;<input type="button" id="btnAdditiveManual" value="Add New Additive" />
            </div>
            <hr />            
            <div><strong>Selected Additives</strong></div>            
            <select multiple="multiple" size="10" id="selAdditive">                
            </select> 
            &nbsp;&nbsp;<input type="button" id="btnRemoveAdditive" value="Remove Selected" />
        </div>
        <div id="Other">
            <div class="divInfo">
                Please select other nutrition sources for this subject. You may check more than one box.
            </div>
            <input type="checkbox" value="breast" name="breastFeeding" id="breastFeeding" /> &nbsp;Ad lib breast feeding
            <br />
            <input type="checkbox" value="solid" name="solidFoods" id="solidFoods" /> &nbsp;Ad lib solid foods
            <br />
            <input type="checkbox" value="drinks" name="drinks" id="drinks" /> &nbsp;Ad lib drinks
            <br />
            <input type="checkbox" value="other" name="other" id="other" /> &nbsp;Other
            <br />
            <div class="divInfo">
                Please describe feeding listed under “other” and write in any other details about feeds that cannot be captured in the calculator entry screens.
            </div>            
            <textarea name="otherText" id="otherText" cols="100" rows="5"></textarea>

        </div>
    </div> @*end div tabs*@
    <div id="results">
        <h3>Results Summary</h3>
        <table id="tblResults">
            <tr>
                <td><strong>Enteral Nutrition</strong></td><td><strong>kCals per day</strong></td><td></td><td><strong>kCals per kg per day</strong></td>
            </tr>
            <tr>
                <td>CHO</td>
                <td id="enteralCHO" class="nTotal">0</td>
                <td></td>
                <td id="enteralCHOPer" class="nTotal"></td>
            </tr>
            <tr>
                <td>Protein</td>
                <td id="enteralProtein" class="nTotal">0</td>
                <td></td>
                <td id="enteralProteinPer" class="nTotal"></td>
            </tr>
            <tr>
                <td>Lipid</td>
                <td id="enteralLipid" class="nTotal">0</td>
                <td></td>
                <td id="enteralLipidPer" class="nTotal"></td>
            </tr>
            <tr>
                <td><strong>Parenteral Nutrition</strong></td><td></td><td></td><td></td>
            </tr>
            <tr>
                <td>CHO</td>
                <td id="parenteralCHO" class="nTotal">0</td>
                <td></td>
                <td id="parenteralCHOPer" class="nTotal"></td>
            </tr>
            <tr>
                <td>Protein</td>
                <td id="parenteralProtein" class="nTotal">0</td>
                <td></td>
                <td id="parenteralProteinPer" class="nTotal"></td>
            </tr>
            <tr>
                <td>Lipid</td>
                <td id="parenteralLipid" class="nTotal">0</td>
                <td></td>
                <td id="parenteralLipidPer" class="nTotal"></td>
            </tr>
            <tr>
                <td><strong>Total Caloric Intake</strong></td><td id="totalCalIntake" class="nTotal">0</td>
                <td></td>
                <td id="totalCalIntakePer" class="nTotal"></td>
            </tr>
            @*<tr>
                <td><strong>Glucose Infusion Rate</strong></td><td id="gir" class="nTotal">0</td>

            </tr>*@
        </table>
    </div>
    <div id="divGir">
        <span class="nTotal"><strong>Study Day Mean GIR:&nbsp;&nbsp;</strong></span><span id="gir"></span><span>&nbsp;mg/kg/min</span> 
        <br/>
        <span id="spanGirRec" class="underline">HALF-PINT GIR recommendations:</span>
        <br/>
        <span class="italic">Subjects less than 6 years of age: At least 5 mg/kg/min</span>
        <br/>
        <span class="italic">Subjects greater than or equal to 6 years of age: At least 2.5 mg/kg/min</span>
    </div>
    <br />
    <div id="divSubmit">
        <input type="button" id="btnSubmit" value="Submit" />
        &nbsp;&nbsp;&nbsp;
        <input type="button" id="btnCancel" value="Cancel" />
        &nbsp;&nbsp;&nbsp;
        <input type="button" id="btnClear" value="Clear all entries" />
        <br/>
        <p class="warning">Only enter data into InForm after you click Submit</p>
    </div>
    <div id="divNewEntry">
        <input type="button" id="btnNewDay" value="Enter new day" />
        &nbsp;&nbsp;&nbsp;
        <input type="button" id="btnNewStudy" value="Enter another study" />
    </div>
    <div>
        @Html.RouteLink("Back to Staff Menu", new {Action="Index", Controller="Staff" });
    </div>
</form>

<div id="divNewFormula">    
    <label>Formula name</label><input type="text" id="newFormulaName" name="newFormulaName" />
    <br /><label>Protein % of kcal</label><input class="keyDecimal" type="text" id="newProtein"/>
    <br /><label>CHO % of kcal</label><input class="keyDecimal" type="text" id="newCHO"/>
    <br /><label>Lipid % of kcal</label><input class="keyDecimal" type="text" id="newLipid"/>
    <br /><label>kCal per mL</label><input class="keyDecimal" type="text" id="newkCalMl"/>
    <br /><input type="button" id="btnSaveNewFormula" value="Save" />&nbsp;&nbsp;&nbsp;<input type="button" id="btnCloseNewFormula" value="Close" />
</div>
<div id="divNewAdditive">    
    <label>Additive name</label><input type="text" id="newAdditiveName" name="newAdditiveName" />
    <br /><label>Select unit</label> @Html.DropDownList("Units")
    <br /><label>Protein % of kcal</label><input class="keyDecimal" type="text" id="newAdditiveProtein"/>
    <br /><label>CHO % of kcal</label><input class="keyDecimal" type="text" id="newAdditiveCHO"/>
    <br /><label>Lipid % of kcal</label><input class="keyDecimal" type="text" id="newAdditiveLipid"/>
    <br /><label>kCal per unit</label><input class="keyDecimal" type="text" id="newkCalUnit"/>
    <br /><input type="button" id="btnSaveNewAdditive" value="Save" />&nbsp;&nbsp;&nbsp;<input type="button" id="btnCloseNewAdditive" value="Close" />
</div>

<link href="@Url.Content("~/Content/calCalc.css")" rel="stylesheet" type="text/css" />
<script src="@Url.Content("~/Scripts/calorieCalc.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.maskedinput-1.3.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/json2.js")" type="text/javascript"></script>
